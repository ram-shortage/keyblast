---
phase: 13-onboarding-defaults
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/config.rs
  - src/main.rs
autonomous: true

must_haves:
  truths:
    - "Fresh install creates config with example macros"
    - "Example macros demonstrate basic text and Enter key"
    - "Example macros demonstrate special keys (Tab, arrows)"
    - "Example macros demonstrate DSL features (Delay, modifier combos)"
    - "Example hotkeys do not conflict with common system shortcuts"
  artifacts:
    - path: "src/config.rs"
      provides: "default_example_macros() function"
      contains: "fn default_example_macros"
    - path: "src/main.rs"
      provides: "Calls default_example_macros when config is empty"
      contains: "default_example_macros"
  key_links:
    - from: "src/main.rs"
      to: "src/config.rs"
      via: "config::default_example_macros()"
      pattern: "config::default_example_macros"
---

<objective>
Add instructive example macros to the default configuration for new users.

Purpose: New users currently get a single minimal example. They need examples that demonstrate the full range of KeyBlast's DSL features so they understand what's possible without reading documentation.

Output: A set of 3 example macros covering basic usage, special keys, and advanced DSL features, created automatically on fresh install.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Key files:
@src/config.rs - Config structures and helpers
@src/main.rs - Lines 301-325 contain current example macro creation
@src/injection.rs - MacroSegment enum shows all DSL features
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create default_example_macros function</name>
  <files>src/config.rs</files>
  <action>
Add a public function `default_example_macros() -> Vec<MacroDefinition>` that returns 3 example macros:

1. **Hello World** (basic intro):
   - name: "Hello World"
   - hotkey: "ctrl+shift+h"
   - text: "Hello from KeyBlast!{Enter}"
   - delay_ms: 0
   - group: Some("Examples")
   - Purpose: Simple demo, types greeting and presses Enter

2. **Form Navigation** (special keys):
   - name: "Form Navigation"
   - hotkey: "ctrl+shift+n"
   - text: "John Doe{Tab}john@example.com{Tab}{Tab}{Enter}"
   - delay_ms: 0
   - group: Some("Examples")
   - Purpose: Shows Tab for field navigation, Enter to submit

3. **Signature with Delay** (DSL features):
   - name: "Signature Block"
   - hotkey: "ctrl+shift+s"
   - text: "Best regards,{Enter}{Delay 100}-- {Enter}Your Name{Enter}your@email.com"
   - delay_ms: 0
   - group: Some("Examples")
   - Purpose: Shows Delay for pacing, multi-line text

Hotkey rationale:
- All use Ctrl+Shift+letter to avoid conflicts with common shortcuts
- H for Hello, N for Navigation, S for Signature - memorable mnemonics
- Ctrl+Shift+H/N/S are rarely used by applications

Each macro gets a fresh UUID via Uuid::new_v4().
  </action>
  <verify>
Run `cargo test` - existing tests pass (no new tests needed for simple data construction).
Verify function compiles: `cargo check`
  </verify>
  <done>
`default_example_macros()` function exists in config.rs and returns 3 MacroDefinition structs with distinct hotkeys and demonstration text.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire example macros into startup</name>
  <files>src/main.rs</files>
  <action>
Modify the existing empty-config handling (around line 301-325) to use the new function:

Replace the inline MacroDefinition construction:
```rust
// OLD (remove this):
let default_macro = config::MacroDefinition {
    id: uuid::Uuid::new_v4(),
    name: "example".to_string(),
    hotkey: "ctrl+shift+k".to_string(),
    text: "Hello from KeyBlast!{Enter}".to_string(),
    delay_ms: 0,
    group: None,
};
let mut cfg = loaded_config;
cfg.macros.push(default_macro);
```

With the function call:
```rust
// NEW:
let mut cfg = loaded_config;
cfg.macros = config::default_example_macros();
```

The rest of the save logic remains unchanged.

Update the info! log message to reflect multiple macros:
- Change from singular "default example macro" to "default example macros"
  </action>
  <verify>
1. Delete config file: `rm -f ~/Library/Application\ Support/keyblast/config.toml` (macOS) or equivalent
2. Run `cargo run` - app starts
3. Check config file contains 3 macros in Examples group
4. Press Ctrl+Shift+H in a text editor - types "Hello from KeyBlast!" and Enter
5. Quit app
  </verify>
  <done>
Fresh install creates config.toml with 3 example macros. Each macro can be triggered via its hotkey and demonstrates its respective feature.
  </done>
</task>

</tasks>

<verification>
1. `cargo check` - compiles without errors
2. `cargo test` - all tests pass
3. `cargo clippy` - no warnings
4. Manual test: Delete config, run app, verify 3 example macros created with correct hotkeys
</verification>

<success_criteria>
- Fresh config contains 3 example macros (Hello World, Form Navigation, Signature Block)
- All example macros are in "Examples" group
- Hotkeys (Ctrl+Shift+H/N/S) are unique and trigger correctly
- Example texts demonstrate: basic typing, special keys (Tab, Enter), and DSL (Delay)
- ONBOARD-01 requirement satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/13-onboarding-defaults/13-01-SUMMARY.md`
</output>
